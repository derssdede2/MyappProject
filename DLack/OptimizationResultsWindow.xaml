<Window x:Class="DLack.OptimizationResultsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Optimization Results"
        Width="640" Height="540"
        MinWidth="480" MinHeight="400"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResizeWithGrip"
        KeyDown="Window_KeyDown">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40"
                      ResizeBorderThickness="6"
                      GlassFrameThickness="0"
                      CornerRadius="14"
                      UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Border CornerRadius="16"
            Background="{DynamicResource BgMain}"
            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
            RenderTransformOrigin="0.5,0.5">
        <Border.RenderTransform>
            <ScaleTransform x:Name="WindowScale" ScaleX="1" ScaleY="1" />
        </Border.RenderTransform>
        <Border.Effect>
            <DropShadowEffect BlurRadius="32" ShadowDepth="2"
                              Opacity="0.18" Color="Black" Direction="270" />
        </Border.Effect>
        <Border.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard>
                        <!-- Scale from 0.96 → 1.0 -->
                        <DoubleAnimation Storyboard.TargetName="WindowScale"
                                         Storyboard.TargetProperty="ScaleX"
                                         From="0.96" To="1.0" Duration="0:0:0.4">
                            <DoubleAnimation.EasingFunction>
                                <CubicEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <DoubleAnimation Storyboard.TargetName="WindowScale"
                                         Storyboard.TargetProperty="ScaleY"
                                         From="0.96" To="1.0" Duration="0:0:0.4">
                            <DoubleAnimation.EasingFunction>
                                <CubicEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Border.Triggers>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- ═══════════════════════════════════════════════════════ -->
            <!--  TITLE BAR                                             -->
            <!-- ═══════════════════════════════════════════════════════ -->
            <Border Grid.Row="0" Background="{DynamicResource HeaderBg}" CornerRadius="15,15,0,0"
                    Padding="20,12,12,12">
                <Border CornerRadius="15,15,0,0" BorderThickness="0,0,0,1" BorderBrush="#10FFFFFF">
                    <Grid>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets" FontSize="18"
                                       Foreground="White" VerticalAlignment="Center" Margin="0,0,10,0" />
                            <TextBlock Text="Optimization Results"
                                       FontFamily="Segoe UI" FontSize="18" FontWeight="SemiBold"
                                       Foreground="White" VerticalAlignment="Center" />
                        </StackPanel>
                        <Button Content="&#xE8BB;" Style="{StaticResource ChromeCloseButton}"
                                HorizontalAlignment="Right" VerticalAlignment="Center"
                                WindowChrome.IsHitTestVisibleInChrome="True"
                                ToolTip="Close"
                                Click="BtnClose_Click" />
                    </Grid>
                </Border>
            </Border>

            <!-- ═══════════════════════════════════════════════════════ -->
            <!--  SUMMARY BANNER                                        -->
            <!-- ═══════════════════════════════════════════════════════ -->
            <Border Grid.Row="1" Background="{DynamicResource BgCard}"
                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1"
                    Padding="20,16">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- Hero status badge -->
                    <Grid x:Name="heroBadge" Width="52" Height="52" Margin="0,0,20,0"
                          RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <ScaleTransform x:Name="heroBadgeScale" ScaleX="0" ScaleY="0" />
                        </Grid.RenderTransform>
                        <Ellipse x:Name="heroRing" Width="52" Height="52"
                                 StrokeThickness="3" Fill="Transparent" />
                        <Ellipse x:Name="heroFill" Width="44" Height="44" Opacity="0.12" />
                        <TextBlock x:Name="heroIcon" FontFamily="Segoe MDL2 Assets" FontSize="22"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Grid>

                    <StackPanel Margin="0,0,24,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE762;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                       Foreground="{DynamicResource BluePrimary}" VerticalAlignment="Center" Margin="0,0,8,0" />
                            <TextBlock x:Name="lblActionCount"
                                       FontFamily="Segoe UI" FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextDark}" />
                        </StackPanel>
                        <TextBlock x:Name="lblActionBreakdown"
                                   FontFamily="Segoe UI" FontSize="11"
                                   Foreground="{DynamicResource TextMuted}" Margin="22,2,0,0" />
                    </StackPanel>
                    <Border Width="1" Height="36" Background="{DynamicResource BorderBrush}"
                            VerticalAlignment="Center" Margin="0,0,24,0" />
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xECAD;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                       Foreground="{DynamicResource GreenSuccess}" VerticalAlignment="Center" Margin="0,0,8,0" />
                            <TextBlock x:Name="lblFreedSpace"
                                       FontFamily="Segoe UI" FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource GreenSuccess}" />
                        </StackPanel>
                        <TextBlock Text="Space recovered"
                                   FontFamily="Segoe UI" FontSize="11"
                                   Foreground="{DynamicResource TextMuted}" Margin="22,0,0,0" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- ═══════════════════════════════════════════════════════ -->
            <!--  ACTION DETAIL LIST                                     -->
            <!-- ═══════════════════════════════════════════════════════ -->
            <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Padding="0,0,4,0">
                <StackPanel x:Name="resultPanel" Margin="16,8,16,8" />
            </ScrollViewer>

            <!-- ═══════════════════════════════════════════════════════ -->
            <!--  BOTTOM BUTTONS                                        -->
            <!-- ═══════════════════════════════════════════════════════ -->
            <Border Grid.Row="3" Background="{DynamicResource BgCard}"
                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0"
                    CornerRadius="0,0,15,15" Padding="20,12">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right"
                            WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button x:Name="btnVerify"
                            Style="{StaticResource BluePrimaryButton}"
                            Width="220" Height="40"
                            Click="BtnVerify_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE895;" FontFamily="Segoe MDL2 Assets" FontSize="13"
                                       VerticalAlignment="Center" Margin="0,0,8,0" />
                            <TextBlock x:Name="lblVerifyText" Text="Verifying in 5s..."
                                       FontFamily="Segoe UI" FontSize="13" FontWeight="SemiBold"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource NeutralButton}"
                            Width="90" Height="40" Margin="10,0,0,0"
                            Content="Close" FontSize="13"
                            Click="BtnClose_Click" />
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
